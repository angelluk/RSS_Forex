<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name='yandex-verification' content='633ab3656de589a1' />
    <title>Forex новости и аналитика</title>

    <link rel="shortcut icon" href="img/siteView/favicon.ico">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
    
    <script src="js/jquery-1.4.2.min.js"></script>

    <script  src="http://www.google.com/jsapi"></script>
    <script  src="js/gfeedfetcher.js"></script>
    <script  src="js/jquery.json.js"></script>
    
  </head>
  <body>

    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="navbar-header">
            <a class="navbar-brand"  href="index.html"><img src="img/siteView/Logo.png"  class="logo" alt="logo"></a>
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-example">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            
        </div>
        <div id="navbar-example" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li class="active"><a href="#">Все</a></li>
                <li><a href="Search.html">&nbsp<img src="img/siteView/t-search.png" height="18" weigth="18" >&nbsp</a></li>
             
            </ul>
           <!--
           <ul class="nav navbar-nav navbar-right">
                 <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">CatForex <span class="caret"></span></a>
                    <ul class="dropdown-menu" role="menu">
                      <li><a href="#">О рейтинге новостей</a></li>
                      <li><a href="#">Как попасть в рейтинг</a></li>
                      <li><a href="#">Правовая информация</a></li>
                      <li class="divider"></li>
                      <li><a href="#">Сообщить о нарушении прав</a></li>
                    </ul>
                  </li>
              </ul>
            -->
        </div>
    </nav>
  
    <div class="container">

        <div class=" col-md-12 ">
          <h1>CAT FOREX  собирает самые актуальные новости валютного рынка на основании умного рейтинга. Подробнее ...<img src="img/siteView/close.png" alt="close"></h1>  
            
            <!-- <input type="submit" value="Play" id="play"class="btn hiddeElement">
            -->
             
             <!-- Modal -->
             <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
               <div class="modal-dialog">
                 <div class="modal-content">
                   <div class="modal-header">
                     <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                     <h4 class="modal-title" id="myModalLabel">Новость</h4>
                   </div>
                   <div class="modal-body"></div>
                   <div class="modal-footer">
                     <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                     </div>
                 </div>
               </div>
             </div>
                  
                <gcse:searchresults  defaultToImageSearch="true"></gcse:searchresults>          

                <div id="rssfeed-wrap" >
            
             <script type="text/javascript">

             function ReqAJAX(){

                 $.ajax({
                       
                       type: "GET",
                       url: "ajax/Source.json",
                       dataType: "json",
                       async:false,
                       
                       success: function( json ) {
                          json.rssfeeds.forEach(function(element) {
                            // добавляем источник RSS
                            newsfeed.addFeed(element.id, element.url,element.rate); 
                          });

                           localStorage.setItem('RSS', JSON.stringify(json));  //  пишем в HTML5 local store
                       },

                       error: function( xhr, status, errorThrown ) {
                              console.log( "Error: " + errorThrown );
                              console.log( "Status: " + status );
                              console.dir( xhr );
                          }
                   });

                 window.location.assign("http://catforex.com/index.html"); // перезагружаемся 
             
              };
                   
              var newsfeed=new gfeedfetcher("rssfeeds", "rssfeedsclass", "_blank")
                   

              //  первый раз  если нет сторадж загружаемся с сервера localStorage.getItem('RSS') !=null

             if ((  localStorage.getItem('RSS') == "undefined" ) || (localStorage.getItem('RSS') == null))
             {

                            //---------------------------------------------------------------------------------------------
                           /*      newsfeed.addFeed("favicons/all-currency.png", "http://all-currency.ru/news/rss.php","10"); 
                                  newsfeed.addFeed("favicons/forex4you.png", "http://blog.forex4you.org/feed/","10"); 
                                  newsfeed.addFeed("favicons/forexco.png", "http://www.forex.co/ru/rss/get/news","10"); 
                                  newsfeed.addFeed("favicons/forexite.png", " http://www.forexite.com/forex_news_rss.xml","10"); 
                                  newsfeed.addFeed("favicons/forexpf.png", " http://www.forexpf.ru/forex.xml","10"); 
                                  newsfeed.addFeed("favicons/forexpf.png", " http://www.forexpf.ru/econom.xml ","10"); 
                                  newsfeed.addFeed("favicons/ForexUA.png", " http://www.forexua.com/ru/analytic/ta.xml","10");
                                  newsfeed.addFeed("favicons/fxclub.png", " http://www.fxclub.org/rss/rubric73/","10");
                                  newsfeed.addFeed("favicons/fxclub.png", " http://www.fxclub.org/rss/sec1249.xml","10");
                                  newsfeed.addFeed("favicons/admiralmarkets.png", " http://feeds.feedburner.com/forextrade/techanalysis?format=xml","10"); 
                                  newsfeed.addFeed("favicons/admiralmarkets.png", " http://feeds.feedburner.com/admiralmarkets/market_focus?format=xml","10"); 
                                  newsfeed.addFeed("favicons/admiralmarkets.png", " http://feeds.feedburner.com/forextrade/waveanalysis?format=xml","10");    
                                  newsfeed.addFeed("favicons/alpari.png", " http://feeds.feedburner.com/alpari-ru-analytics?format=xml","10"); 
                                  newsfeed.addFeed("favicons/fxstreet.png", "http://www.fxstreet.ru.com/rss/news/forex-news/","10"); 
                                  newsfeed.addFeed("favicons/gkfx.png", "https://www.gkfx.ru/analytics.rss","10"); 
                                  newsfeed.addFeed("favicons/instaforex.png", "https://news.instaforex.com/ru/analytics","10");
                                  newsfeed.addFeed("favicons/instaforex.png", "https://news.instaforex.com/ru/news","10");
                                  newsfeed.addFeed("favicons/investfunds.png", "http://investfunds.kz/rss/news/forex/","10");
                                  newsfeed.addFeed("favicons/investing.png", "http://ru.investing.com/rss/news_1.rss","10");
                                  newsfeed.addFeed("favicons/mt5.png", "http://news.mt5.com/ru/news/rss","10");
                                  newsfeed.addFeed("favicons/novosti.investaz.png", "http://novosti.investaz.ru/feed/","10");
                                  newsfeed.addFeed("favicons/panteon-finance.png", " https://panteon-finance.com/rss/","10");
                                  newsfeed.addFeed("favicons/radioforex.png", " http://radioforex.ru/rss.xml","10");
                                  newsfeed.addFeed("favicons/rbc.png", "http://static.feed.rbc.ru/rbc/internal/rss.rbc.ru/quote.ru/mainnews.rss","10");
                                  newsfeed.addFeed("favicons/ria.png", " http://ria.ru/export/rss2/money/index.xml","10");
                                  newsfeed.addFeed("favicons/rosinvest.png", " http://rosinvest.com/newsrubrik_13.rss","10"); 
                                  newsfeed.addFeed("favicons/rusbanks.png", " http://www.rusbanks.info/news/rss/","10"); 
                                  newsfeed.addFeed("favicons/rvdmarkets.png", " https://www.rvdmarkets.com/ru/rss/markets-news ","10"); 
                                  newsfeed.addFeed("favicons/rvdmarkets.png", "https://www.rvdmarkets.com/ru/rss/analytics-recommendations","10");  
                                  newsfeed.addFeed("favicons/stock-maks.png", "http://stock-maks.com/ta/rss.xml","10"); 
                                  newsfeed.addFeed("favicons/stock-maks.png", "http://stock-maks.com/op/rss.xml","10"); 
                                  newsfeed.addFeed("favicons/teletrade.png", "http://www.teletrade.com.ua/rss/analytics/news/currency","10"); 
                                  newsfeed.addFeed("favicons/teletrade.png", "http://www.teletrade.com.ua/rss/analytics/reviews/currency","10"); 
                                  newsfeed.addFeed("favicons/teletrade.png", "http://www.teletrade.com.ua/rss/analytics/technical_analysis/all","10"); 
                                  newsfeed.addFeed("favicons/teletrade.png", "http://www.teletrade.com.ua/rss/analytics/blogs/all","10");
                                  newsfeed.addFeed("favicons/traderblog.png", "http://traderblog.biz/feed/","10");
                                  newsfeed.addFeed("favicons/tradersroom.png", "http://tradersroom.ru/translation?format=feed&type=rss","10");
                                  newsfeed.addFeed("favicons/traders-union.png", "https://traders-union.ru/brokers-analytics/rss/","10");
                                  newsfeed.addFeed("favicons/traders-union.png", "https://traders-union.ru/news/forex/rss/","10");  
                                  newsfeed.addFeed("favicons/vestifinance.png", "http://www.vestifinance.ru/yandex.xml","10"); 
            */
           
               ReqAJAX(); //  запрос JSON
             } 
             else
             {

                var OBJ = JSON.parse(localStorage.getItem('RSS'));  // читаем из  HTML5 local store

                OBJ.rssfeeds.forEach(function(element) {    
                    
                      newsfeed.addFeed(element.id, element.url,element.rate); 
                 });
             }


                    newsfeed.displayoptions("label  datetime ");
                    newsfeed.setentrycontainer("li");
                    newsfeed.filterfeed(50, "rates");
                    newsfeed.init();
                    
                    setInterval(function(){newsfeed.init()}, 1800000); // вызов обновления раз в полчаса

                    </script>
                   
                    
                </div>
             <button type="button" onclick="javascript:newsfeed.init()" class="btn btn-default">Обновить</button>

             <button type="button" onclick="javascript:ReqAJAX()" class="btn btn-default">Обнулить</button>

        </div>
    </div>

    <div class="blog-footer">
    
      <ul>
        <li><a href="#">О рейтинге новостей</a></li>
        <li><a href="#">Как попасть в рейтинг</a></li>
        <li><a href="#">Правовая информация</a></li>
        <li><a href="#" id="last-href">Сообщить о нарушении прав</a></li>
      </ul>
      <p>
        <span> &copy; 2014</span>
      </p>
      
    </div>

     <script>
     
        var Diff,MoveFirstIndex,MoveSecondIndex,RealFirst,RealSecond;
        var OBJ;

        // функция возврата случайного числа из диапазона
        var getRandom = function (min,max){
           return Math.floor(Math.random()*(max-min) + min);

        };

        // функция  случайной аннимации
        var Shuttle = function (len){

          MoveFirstIndex = getRandom(0,len);
          MoveSecondIndex = getRandom(0,len);

          Diff = Math.abs(MoveSecondIndex-MoveFirstIndex);

          RealFirst = 0;
          RealSecond=0;

        };

     $(document).ready(function(){

        //---------------------------------- Rating click event ---------------------------------------
        var Voterate = 10.0;   // СИЛА КЛИКА В РЕЙТИНГЕ

        $( "body" ).on( "click", "li", function( event ) {
            
    
            //вытягиваем источник новости
            event.stopPropagation();
            var cur = $(this);
            var Sorce = cur[0].childNodes[1].src.split('/');
            var Fider = "favicons/"+Sorce[Sorce.length-1];
            console.log(Fider);

            // ЧИТАЕМ
             OBJ = JSON.parse(localStorage.getItem('RSS'));  // читаем из  HTML5 local store

             OBJ.rssfeeds.forEach(function(element) {    // увеличим рейтинг
                    
                     if (element.id==Fider) 
                     {
                        element.rate = (parseFloat(element.rate)+Voterate).toString();
                        console.log(element); 
                     }
                        
                   });
          
           // ПИШЕМ
            localStorage.setItem('RSS', JSON.stringify(OBJ));  //  пишем в HTML5 local store

          });  

          //---------------------------------------------------------------------------------------------
        
         var Play = function(){

           Shuttle(30);  // берем случайно 2 новости 

           // список новостей
           var Lists = $("#rssfeeds li");

           var FirstMove ,SecondMove,colorFirst,colorSecond;  

           if(MoveFirstIndex !== MoveSecondIndex){

            var FirstCSS = "#rssfeeds li:eq(" + MoveFirstIndex + ")";
            var SecondCSS = "#rssfeeds li:eq(" + MoveSecondIndex + ")";
            
            // реальное  свойтсво top         
            var RealFirst = Lists[MoveFirstIndex].offsetTop;
            var RealSecond = Lists[MoveSecondIndex].offsetTop;

            var MovePx  = Math.abs(RealFirst-RealSecond); // разница to

              if (RealFirst > RealSecond){

                 FirstMove = "-="+ MovePx + "px";
                 SecondMove = "+="+ MovePx + "px";
                
                 colorFirst = '#B9FFB9';
                 colorSecond = '#FFA8A8';  
                 
              }
              else{

                 FirstMove = "+="+ MovePx + "px";
                 SecondMove = "-="+ MovePx + "px";

                 colorFirst ='#FFA8A8';
                 colorSecond = '#B9FFB9';   

              }

              var One = $(FirstCSS);
              var Two = $(SecondCSS);

              $(One).animate({ 'top': FirstMove },1500); 
              $(Two).animate({ 'top': SecondMove },1500);

              $(FirstCSS + " .rating").css('background-color', colorFirst);
              $(SecondCSS + " .rating").css('background-color', colorSecond); 
              
           }
             
         };
           // закрытие  заголовка
           $("h1 img").on("click",function (){
             
             $(this).addClass("hiddeElement");
             $(this).parent().addClass("hiddeElement");

           });

          // аннимация случайная
          $("#play").click(function () {
            
               setInterval(function(){Play()}, 6000); // вызов обновления раз в минуту
                      
           });

     });

    </script>

    <!-- =============================Google Analytics=======================================-->
    <script>
     /* (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-30528080-3', 'auto');
      ga('send', 'pageview');
*/
    </script>
    <!-- =====================================================================================-->
  
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>

  </body>
</html>